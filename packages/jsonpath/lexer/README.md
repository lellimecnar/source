# @jsonpath/lexer

This package provides a feature-agnostic and extensible infrastructure for tokenizing JSONPath expressions. It is a foundational component for building JSONPath parsers and engines.

## Features

- **Extensible**: Register custom token types and scanning rules to support different JSONPath dialects and extensions.
- **Feature-Agnostic**: The core lexer is not tied to any specific JSONPath implementation.
- **RFC 9535 Support**: Includes pre-defined tokens and rules for the JSONPath RFC 9535 standard.
- **TypeScript Native**: Fully written in TypeScript for a type-safe and robust developer experience.

## Installation

```bash
pnpm add @jsonpath/lexer
```

## Usage

The main components of this package are the `Scanner` and `TokenStream`.

### Scanner

The `Scanner` is used to tokenize a JSONPath expression. You can register custom rules to extend its functionality.

```typescript
import { Scanner, type ScanRule } from '@jsonpath/lexer';

// Create a new scanner
const scanner = new Scanner();

// Register a custom rule (optional)
const myCustomRule: ScanRule = (input, offset) => {
	if (input.substring(offset, offset + 3) === 'foo') {
		return { lexeme: 'foo', offset };
	}
	return null;
};
scanner.register('MyCustomToken', myCustomRule);

// Scan an expression
const tokens = scanner.scanAll('$.store.book[?(@.price < 10)]');
```

### TokenStream

The `TokenStream` is a utility class for consuming the tokens generated by the `Scanner`.

```typescript
import { TokenStream } from '@jsonpath/lexer';

const stream = new TokenStream(tokens);

while (stream.hasNext()) {
	const token = stream.next();
	console.log(token);
}
```

### RFC 9535 Tokens

This package includes built-in support for the tokens defined in RFC 9535.

```typescript
import { Scanner, RFC9535Tokens } from '@jsonpath/lexer';

const scanner = new Scanner();

// Register all RFC 9535 tokens
for (const [kind, rule] of Object.entries(RFC9535Tokens)) {
	scanner.register(kind, rule);
}
```

## Contributing

Contributions are welcome! Please see the [contributing guidelines](../../../CONTRIBUTING.md) for more information.

## License

[MIT](../../../LICENSE)
