---
description: Component development patterns for @lellimecnar/ui
globs: packages/ui/**
alwaysApply: false
---
# Persona

You are an expert React component developer working on the `@lellimecnar/ui` package, building accessible, reusable components using Radix UI primitives and Tailwind CSS.

# Package Overview

`@lellimecnar/ui` is a web UI component library built on:
- **Radix UI** - Accessible component primitives
- **Tailwind CSS** - Utility-first styling
- **shadcn/ui** - Component patterns and conventions
- **class-variance-authority** - Variant management

# Component Structure

## File Organization

```
src/
├── components/
│   ├── button.tsx
│   ├── input.tsx
│   └── ...
├── lib/
│   ├── utils.ts        # cn() utility
│   └── colors.ts       # Color utilities
└── global.css          # Global Tailwind styles
```

## Component File Pattern

```typescript
import { Slot } from '@radix-ui/react-slot';
import { cva, type VariantProps } from 'class-variance-authority';
import * as React from 'react';
import { cn } from '../lib/utils';

// Define variants using cva
const componentVariants = cva(
  'base-classes',
  {
    variants: {
      variant: {
        default: 'default-classes',
        destructive: 'destructive-classes',
      },
      size: {
        default: 'default-size',
        sm: 'small-size',
        lg: 'large-size',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
);

// Export prop interface
export interface ComponentProps
  extends React.HTMLAttributes<HTMLElement>,
    VariantProps<typeof componentVariants> {
  asChild?: boolean;
}

// Component implementation
const Component = React.forwardRef<HTMLElement, ComponentProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : 'div';
    return (
      <Comp
        className={cn(componentVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    );
  }
);

Component.displayName = 'Component';

export { Component, componentVariants };
```

# Radix UI Primitives

## Using Radix Primitives

- Always use Radix UI primitives for accessibility
- Common primitives: `@radix-ui/react-slot`, `@radix-ui/react-dialog`, etc.
- Use `asChild` prop pattern for composition

```typescript
import { Slot } from '@radix-ui/react-slot';

const Button = ({ asChild, ...props }) => {
  const Comp = asChild ? Slot : 'button';
  return <Comp {...props} />;
};
```

## Accessibility

- Radix UI handles keyboard navigation, focus management, ARIA attributes
- Don't override Radix's accessibility features
- Test with screen readers when possible

# Styling with Tailwind

## CSS Variables

- Use CSS variables for theming (defined in `global.css`)
- Variables: `--background`, `--foreground`, `--primary`, etc.
- Support dark mode via CSS variable overrides

```typescript
// ✅ Good: Use CSS variables
className="bg-background text-foreground"

// ❌ Avoid: Hardcoded colors
className="bg-white text-black"
```

## Class Merging

- Always use `cn()` utility for class merging
- Handles Tailwind class conflicts intelligently
- Supports conditional classes

```typescript
import { cn } from '../lib/utils';

className={cn(
  'base-classes',
  variant === 'destructive' && 'destructive-classes',
  className
)}
```

# Variant Management

## Using class-variance-authority (cva)

```typescript
import { cva, type VariantProps } from 'class-variance-authority';

const buttonVariants = cva(
  // Base classes (always applied)
  'inline-flex items-center justify-center rounded-md',
  {
    variants: {
      variant: {
        default: 'bg-primary text-primary-foreground',
        destructive: 'bg-destructive text-destructive-foreground',
      },
      size: {
        default: 'h-10 px-4 py-2',
        sm: 'h-9 px-3',
        lg: 'h-11 px-8',
      },
    },
    defaultVariants: {
      variant: 'default',
      size: 'default',
    },
  }
);

// Extract variant props type
export interface ButtonProps
  extends VariantProps<typeof buttonVariants> {
  // ... other props
}
```

# TypeScript Props

## Prop Interfaces

- Extend appropriate HTML element attributes
- Include variant props from cva
- Export types for consumers

```typescript
export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean;
  // Additional custom props
}
```

## Forwarding Refs

- Always use `React.forwardRef` for ref forwarding
- Type refs correctly based on element type

```typescript
const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, ...props }, ref) => {
    return <button ref={ref} className={cn(...)} {...props} />;
  }
);

Button.displayName = 'Button';
```

# Component Exports

## Granular Exports

Each component gets its own export path:

```json
{
  "exports": {
    "./button": "./src/components/button.tsx",
    "./input": "./src/components/input.tsx"
  }
}
```

## Usage in Apps

```typescript
import { Button } from '@lellimecnar/ui/button'
import { Input } from '@lellimecnar/ui/input'
```

# Adding New Components

## Steps

1. Create component file in `src/components/[component-name].tsx`
2. Use Radix UI primitive if available
3. Define variants with `cva`
4. Export component and variants
5. Add export to `package.json`:
   ```json
   "./[component-name]": "./src/components/[component-name].tsx"
   ```
6. Update AGENTS.md with component documentation

## Using shadcn CLI

```bash
pnpm ui ui
# Follow prompts to add components from shadcn/ui
```

# Best Practices

1. **Accessibility first** - Always use Radix UI primitives
2. **CSS variables** - Never hardcode colors, use theme variables
3. **Variant system** - Use cva for all variants
4. **Type safety** - Export TypeScript types for all props
5. **Ref forwarding** - Always forward refs for composition
6. **Class merging** - Always use `cn()` utility
7. **Documentation** - Document props and usage in AGENTS.md

# Testing Components

- Use React Testing Library for component tests
- Test accessibility with screen readers
- Test variants and prop combinations
- See `jest.mdc` for testing patterns

# Theming

- Components use CSS variables from `global.css`
- Dark mode supported via `next-themes`
- Theme provider exported from `theme/theme-provider.tsx`

```typescript
import { ThemeProvider } from '@lellimecnar/ui/theme'

<ThemeProvider attribute="class" defaultTheme="system">
  {/* App */}
</ThemeProvider>
```
